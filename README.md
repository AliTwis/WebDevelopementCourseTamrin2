# WebDevelopementCourseTamrin2

در کد بنده، هر دو حالت درگ و دراپ و کلیک کردن پیاده شده است. برای تغییر ابزار کشیدن، کافی‌ست بر روی آن کلیک کنید و یا یکبار درگ و دراپش کنید.

نحوه پیاده‌سازی:

بخش اصلی برنامه‌ی ما در صفحه‌اصلی انجام می‌شود. این صفحه دارای متغیر از استیت می‌باشد که در خود لیستی از اشکالی که در این نقاشی کشیده شده اند نگه می‌دارد. اطلاعاتی که برای هر شکل نگه داشته می‌شود شامل نوع آن، پوزیشن نسبی او نسبت به کانواس، آیدی‌ای که هنگام ساخت آن شکل ه او اختصاص داده‌ایم می‌باشد.

برای کشیدن اشکال در کانواس، در دو حالت درگ و دراپ و کلیک کردن بر روی کانواس، به کمک ایونتی که به ما برگردانده می‌شود، می‌توان به کلاینت اکس و وای دسترسی پیدا کرد که پوزیشن موس نسبت به ویوپورت می‌باشد. از طرفی با دادن یک آیدی به کانواس می‌توانیم پوزیشن او نسبت به ویوپورت را بدست آوریم. در نتیجه با کم کردن عدد دوم از اولی، موقعیت نسبی شکلی که باید کشیده شود نسبت به نقطه بالا چپ کانواس بدست می‌آید و می‌توانیم در آن پوزیشن این شکل را بکشیم.

برای کشیدن اشکال، از کامپوننت جدیدی استفاده میکنیم. اسم این کامپوننت را شیپ گذاشتیم که به عنوان ورودی، پارامترهای ذخیره شده برای شکل که در بالا به آنها اشاره شد، به همراه خود آن لیست و تابعی که استیت آن لیست را ست می‌کند را دریافت می‌کند. سپس با توجه به نوع شکل، وسط شکل را پوزیشن داده شده قرار می‌دهیم و یک دیو که در خود عکس مدنظر را دارد را برمی‌گردانیم. دیو مذکور در پوزیشن مطلوب قرار دارد که با ابسلوت کردن پوزیشن و ست کردن چپ و بالای او مقدور شده است. عکس ما نیز این خاصیت را دارد که در صورت دابل کلیک شدن بر روی خود، به کمک تابع ستی که هنگام ساخت کامپوننت از صفحه‌ی اصلی دریافت کرده ایم، خود را از آن لیست حذف می‌کنیم.

نکته‌ای که در مورد کشیدن اشکال وجود دارد این است که در صورتی که بیش از اندازه نزدیک به محیط کانواس باشیم، آن شکل را قرار نمی‌دهیم تا از کانواس بیرون نزند.

برای اکسپورت کردن داده، آن را به همراه اسمی که کاربر برای نقاشی تغیین کرده است (در یک اینپوت تکست) به کمک جیسون به یک استرینگ تبدیل می‌کنیم و به کمک بلاب و یک انکر این فایل را در قالب تکست قابل دانلود در اختیار کاربر قرار می‌دهیم.

برای ایمپورت کردن، یک اینپوت از نوع فایل داریم که هر بار که فایل انتخاب شده توسط کاربر تغییر کند، آن را به کمک جیسون بر می‌گرداند و اسم نقاشی را اسم ذخیره شده قرار می‌دهد و استیت لیست اشکال را به لیست ذخیره شده در فایل ست می‌کند.

برای شمارش اشکال، تابعی قرار دادیم که روی لیست فور میزند و تعداد شکل مدنظر را شمرده و بر می‌گرداند. با توجه به اینکه لیست ما استیت است، هر بار که تغییر کند این تابع مجددا صدا می‌شود و تعداد آپدیت می‌شود.

برای انتخاب شکلی که باید بکشیم، یک استیت داریم که به طور پیشفرض دایره می‌باشد. در بخش تولز برای هر یک از اشکال موجود، یک نماینده قرار دارد که هرگاه درگی از آنها آغاز شود و یا بر روی آنها کلیک شود، این استیت به شکل آن نماینده ست می‌شود. در نتیجه هنگام دراپ و یا کلیک شدن بر روی کانواس، می‌دانیم کدام شکل را باید به کامپوننت شیپ پاس بدهیم.

برای هندل کردن حذف شکل در صورت دابل کلیک، علاوه بر نکته‌ای که برای کامپوننت شیپ شرح دادیم، نیاز به تغییری در کانواس داریم. علت این موضوع این است که اگر به ازای هر کلیک بر کانواس، ما شکل جدیدی بسازیم، هنگام دابل کلیک یک شکل جدید ساخته می‌شود، در حالیکه هدف ما حذف یک شکل موجود بوده است. برای بر طرف کردن این مشکل، یک متغیر در صفحه‌ی اصلی تعریف می‌کنیم که می‌گوید آیا دابل کلیک رخ داده است یا خیر. هنگامی که بر کانواس کلیک شود، در صورتی که کلیک اول باشد ( که می‌شود به کمک پارامتر دیتیلز برای ایونت کلیک این موضوع را فهمید.)، با دیلی نیم ثانیه‌ای چک می‌کنیم که آیا این متغیر ترو است یا فالس که در صورت فالس بودن شکل را می‌کشیم. این متغیر زمانی ترو می‌شود که که کلیک دوم زده شده باشد که با توجه به دیلی‌ای که برای کلیک اول قرار دادیم، این متغیر تا آن زمان به درستی ست شده است و در نتیجه کد به درستی کار می‌کند.

